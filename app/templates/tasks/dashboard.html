{% extends "base.html" %}

{% block title %}Dashboard | SmartTask{% endblock %}

{% block content %}
<div class="dashboard-container">

    <h2>My Tasks</h2>

    <!-- ================= ADD TASK ================= -->
    <div class="task-form-card">
        <h3>Add New Task</h3>

        <form method="POST" action="{{ url_for('tasks.create_task') }}">
            {{ form.hidden_tag() }}

            <div class="form-group">
                {{ form.title.label }}
                {{ form.title(class="form-control") }}
            </div>

            <div class="form-group">
                {{ form.description.label }}
                {{ form.description(class="form-control") }}
            </div>

            <div class="form-group">
                {{ form.submit(class="btn btn-primary") }}
            </div>
        </form>
    </div>

    <!-- ================= PENDING TASKS ================= -->
    <div class="task-section">
        <h3>Pending Tasks</h3>

        {% if pending_tasks %}
            <ul class="task-list">
                {% for task in pending_tasks %}
                    <li class="task-item">
                        <div class="task-info">
                            <strong>{{ task.title }}</strong>
                            {% if task.description %}
                                <p>{{ task.description }}</p>
                            {% endif %}
                        </div>

                        <div class="task-actions">
                            <a href="{{ url_for('tasks.toggle_task', task_id=task.id) }}"
                               class="btn btn-secondary">
                                Mark Completed
                            </a>

                            <a href="{{ url_for('tasks.edit_task', task_id=task.id) }}"
                               class="btn btn-primary">
                                Edit
                            </a>

                            <a href="{{ url_for('tasks.delete_task', task_id=task.id) }}"
                               class="btn btn-danger"
                               onclick="return confirm('Are you sure you want to delete this task?');">
                                Delete
                            </a>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No pending tasks.</p>
        {% endif %}
    </div>

    <!-- ================= COMPLETED TASKS ================= -->
    <div class="task-section">
        <h3>Completed Tasks</h3>

        {% if completed_tasks %}
            <ul class="task-list">
                {% for task in completed_tasks %}
                    <li class="task-item completed">
                        <div class="task-info">
                            <strong>{{ task.title }}</strong>
                            {% if task.description %}
                                <p>{{ task.description }}</p>
                            {% endif %}
                        </div>

                        <div class="task-actions">
                            <a href="{{ url_for('tasks.toggle_task', task_id=task.id) }}"
                               class="btn btn-secondary">
                                Mark Pending
                            </a>

                            <a href="{{ url_for('tasks.delete_task', task_id=task.id) }}"
                               class="btn btn-danger"
                               onclick="return confirm('Are you sure you want to delete this task?');">
                                Delete
                            </a>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No completed tasks.</p>
        {% endif %}
    </div>

</div>
{% endblock %}
